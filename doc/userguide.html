<HTML>
<HEAD>
<TITLE>PDB2PQR User Guide</TITLE>
<link rel="stylesheet" href="http://agave.wustl.edu/css/baker.css" type="text/css">
</HEAD>
<BODY>
<h2>PDB2PQR User Guide</h2><P>
<B>Table of Contents</B><P>
<a href="#introduction">Introduction</a><BR>
<a href="#availability">Availability</a><BR>
<a href="#installation">Source Installation</a><BR>
<a href="#using">Using PDB2PQR</a><BR>
<a href="#algorithm">Algorithm Descriptions</a><BR>
<a href="#faq">Frequently Asked Questions</a><BR>
<a href="#bug">Bug Reports and Suggestions</a><BR>
<HR>
<a name="introduction"></a>
<h3>Introduction</h3><P>
PDB2PQR is a Python software package that automates many of the common tasks of preparing structures for continuum electrostatics calculations.  This includes adding a limited number of missing heavy atoms to biomolecular structures, optimizing the protein for favorable hydrogen bonding, determining side-chain pKas, and assigning charge and radius parameters from a variety of force fields, ultimately yielding a final PQR file.<P>

PDB2PQR was ported to Python by Todd Dolinsky while working with <a href="http://agave.wustl.edu">Nathan Baker</a> at Washington University in St. Louis.  The PDB2PQR code is based on C++ design and algorithms by Jens Erik Nielsen.  For a full author list please see the <a href="#authors">contributing authors</a>.<P>


PDB2PQR uses <a href="http://propka.ki.ku.dk">PropKa</a> to determine protein pKa values.  PropKa is developed by the <a href="http://www.uiowa.edu/~quantum/">Jensen Research Group</a> at the University of Iowa.  More information about PropKa can be found at  <a href="http://propka.ki.ku.dk">http://propka.ki.ku.dk</a>.<P>

<B>Financial support.</B> The development of PDB2PQR has been supported financially by:
<ul>
<li><a href="http://www.nih.gov/">National Institutes of Health</a> (grant GM069702-01)
<li><a href="http://www.npaci.edu/">National Partnership for Advanced Computational Infrastructure</a> Alpha Project program
<li><a href="http://nbcr.sdsc.edu/">National Biomedical Computation Resource</a>
</ul>

<B>Citing PDB2PQR.</B> Please acknowledge your use of PDB2PQR by citing:<P>
<blockquote><a href="http://nar.oupjournals.org/cgi/content/abstract/32/suppl_2/W665">Dolinsky TJ, Nielsen JE, McCammon JA, Baker NA. PDB2PQR: an automated pipeline for the setup, execution, and analysis of Poisson-Boltzmann electrostatics calculations. Nucleic Acids Research 32 W665-W667 (2004).</a></blockquote>

<B>Citing PropKa.</B>  Please acknowledge your use of PropKa by citing:<P>
<blockquote>Hui Li, Andrew D. Robertson, and Jan H. Jensen. "Very Fast Empirical Prediction and Rationalization of Protein pKa Values." <I>Proteins</I>, 61: 704-721, 2005.</blockquote>
  
<a name="authors"></a>
<B>Contributing Authors.</B>  PDB2PQR was initially written in C++ by Jens Erik Nielsen before being ported to Python by Todd Dolinsky. The full author list is as follows (in alphabetical order):
<ul>
<li> <a href="mailto:baker@biochem.wustl.edu">Nathan Baker</a> (Washington University in St. Louis)<BR> Advisor and contributor of functions for parsing PDB files.<P>
<li> <a href="mailto:todd@ccb.wustl.edu">Todd Dolinsky</a> (Washington University in St. Louis)<BR> Author of Python code.<P>
<li> <a href="mailto:jan-jensen@uiowa.edu">Jan Jensen</a> (University of Iowa)<BR> Co-author of PropKa.<P>
<li> Hui Li (University of Iowa)<BR> Co-author of PropKa.<P>
<li> <a href="mailto:Jens.Nielsen@ucd.ie">Jens Erik Nielsen</a> (University College Dublin)<BR> Author of initial C++ PDB2PQR code and optimization routines.<P><li> Andrew D. Robertson (University of Iowa)<BR> Co-author of PropKa.<P>
</ul>

<B>Mailing Lists.</B>
There are two mailing lists associated with the PDB2PQR software:<BR>
<ul>
<li>pdb2pqr-announce: A low-traffic list for announcements regarding bugs and new versions of the software<BR>
<a href="http://lists.sourceforge.net/lists/listinfo/pdb2pqr-announce">List web page</a><BR>
<a href="http://sourceforge.net/mailarchive/forum.php?forum=pdb2pqr-announce">List archives</a><P>
<li>pdb2pqr-users: A list for discussion of PDB2PQR, troubleshooting, and reporting potential bugs<BR>
<a href="http://lists.sourceforge.net/lists/listinfo/pdb2pqr-users">List web page</a><BR>
<a href="http://sourceforge.net/mailarchive/forum.php?forum=pdb2pqr-users">List archives</a><P>
</ul>

<B>Programmer's Guide.</B>
In addition to this User Guide, a <a href="programmerguide.html">Programmer's Guide</a> has been added for additional documentation.  If you plan to add/edit PDB2PQR you might find it useful to briefly look through the topics addressed.

<HR>

<a name="availability"></a>
<h3>Availability</h3><P>
PDB2PQR is available as both a web service and as command-line software for download.  The PDB2PQR web server can be found at three mirrors:<BR>
<UL>
<li><a href="http://agave.wustl.edu/pdb2pqr/server.html">Washington University in St. Louis</a><BR>
<li><a href="http://nbcr.net/pdb2pqr">NBCR at the San Diego Supercomputer Center (UCSD)</a><BR>
<li><a href="http://enzyme.ucd.ie/Services/pdb2pqr">University College Dublin, Ireland.</a></ul><P>  
The command line PDB2PQR is freely available for download from the SourceForge Project Page at <a href="http://pdb2pqr.sourceforge.net">http://pdb2pqr.sourceforge.net</a>.
<P>
<hr>

<a name="installation"></a>
<h3>Source Installation</h3><P>
As the bulk of the PDB2PQR code is written in Python, the PDB2PQR code itself is architecture/compiler independent.  PDB2PQR has been tested using Python versions 2.2 through 2.4 - problems may occur with older versions.  The PropKa code, however, is written in Fortran - and thus to use it with PDB2PQR a two step installation is necessary, making use of available C and Fortran compilers:<P>
<blockquote><code>
$ ./configure <BR>
$ make <BR>
</code></blockquote>
This should compile the PropKa wrappers necessary to interface with PDB2PQR.<P>  

No additional steps are needed to install PDB2PQR without propka support - just make sure that a version of Python is found in your system path.<P>

If the compilation fails please check the <a href="#faq">FAQ</a> section of this user guide, or if all else fails, send a <a href="#bug">bug report</a>.<P>
<HR>

<a name="using"></a>
<h3>Using PDB2PQR</h3><P>

<I>Starting PDB2PQR and Available Options</I><P>
Starting PDB2PQR from the web server is rather straightforward - simply click the desired options, specify or upload a PDB file, and submit the job.  The command line version of PDB2PQR is similar:<P>
<blockquote><code>
$ python pdb2pqr.py [options] --ff={forcefield} {path} {output-path}
</code></blockquote>

The required arguments are as follows:
<pre>
        &lt;forcefield&gt;  :  The forcefield to use - currently
                         amber, charmm, and parse are supported.
        &lt;path&gt;        :  The path to the PDB file or an ID
                         to obtain from the PDB archive
        &lt;output-path&gt; :  The desired output name of the PQR file
                         to be generated
</pre>

Optional command-line arguments are:
<pre>
        --nodebump    :  Do not perform the <a href="#algorithm">debumping</a> operation
        --noopt       :  Do not perform <a href="#algorithm">hydrogen bonding network optimization</a>
        --chain       :  Keep the chain ID in the output PQR file
        --assign-only :  Only assign charges and radii - do not add
                         atoms, debump, or optimize.
        --clean       :  Do no optimization, atom addition, or
                         parameter assignment, just return the
                         original PDB file in aligned format.
        --ffout=&lt;name&gt;:  Instead of using the standard canonical
                         naming scheme for residue and atom names,
                         use the names from the given forcefield.
        --with-ph=&lt;ph&gt;:  Use propka to calculate pKas and apply them
                         to the molecule given the pH value. Actual
                         PropKa results will be output to 
                         &lt;output-path&gt;.propka.
        --apbs-input  :  Create a template <a href="http://apbs.sourceforge.net">APBS</a> input file based on
                         the generated PQR file.
        --verbose (-v):  Print information to stdout
        --help    (-h):  Display the usage information
</pre>

Additional optional command-line arguments from the <a href="programmerguide.html#extensions">extensions</a> directory are:
<pre>
        --chi         :  Print the per-residue backbone chi
                         angle to {output-path}.chi
        --phi         :  Print the per-residue backbone phi
                         angle to {output-path}.phi
        --psi         :  Print the per-residue backbone psi
                         angle to {output-path}.psi
        --rama        :  Print the per-residue phi and psi
                         angles to {output-path}.rama for
                         Ramachandran plots
        --hbond       :  Print a list of hydrogen bonds to
                         {output-path}.hbond
</pre>

<hr>
<a name="algorithm"></a>
<h3>Algorithm Descriptions</h3><P>
<I>Debumping Algorithm</I><P>
The debumping algorithm ensures that any new heavy or hydrogen atoms are not rebuilt within the Van der Waals radii of existing atoms.  If this does occur, the sidechain of the residue in question will be rotated about an available &Chi; angle until the steric conflict is resolved.<P>

The number of residues that need to be debumped depends on the nature of the system and if hydrogen optimization will be performed. If hydrogens are the only atoms missing any potential conflicts are usually due to hydrogen bonds, and if optimization is enabled these conflicts are usually resolved during that step.  In the case where a large number of heavy sidechain atoms are missing there could be additional debumping necessary - as the sidechain is rebuilt the initial  &Chi; angle may not be the optimal one, and thus a steric conflict may occur.<P>

<I>Hydrogen Bonding Network Optimization</I><P>
The hydrogen bonding network optimization seeks, as the name suggests, to optimize the hydrogen bonding network of the protein.  Currently this entails manipulating the following residues:
<ul>
<li> Flipping the side chains of HIS (including user defined HIS states), ASN, and GLN residues;
<li> Rotating the sidechain hydrogen on SER, THR, TYR, and CYS (if available);
<li> Determining the best placement for the sidechain hydrogen on neutral HIS, protonated GLU, and protonated ASP;
<li> Optimizing all water hydrogens.
</ul>

<hr>
<a name="faq"></a>
<h3>Frequently Asked Questions</h3><P>

<I> What is a PQR file?</I>
<blockquote> A PQR file is a PDB file with the temperature and occupancy columns replaced by columns containing the per-atom charge (Q) and radius (R).  PQR files are used in several computational biology packages, including <a href="http://apbs.sourceforge.net">APBS</a>.</blockquote>

<I> What forcefields are available?</I>
<blockquote> PDB2PQR currently has built in support for AMBER 94, CHARMM 27, and PARSE.  You may also supply a user-defined forcefield.</blockquote>

<a name="userff"></a>
<I> Can I add my own charge and radius parameters to PDB2PQR? </I>
<blockquote> Yes you can.  Depending upon what is needed there are several options available:<P>
<B>Adding a few additional parameters to an existing forcefield</B>
<blockquote>In the case where you want to supplement an existing forcefield (i.e. AMBER, CHARMM, or PARSE) with a few additional atoms, you can either directly add these atoms to the respective forcefield's DAT file (found in the <code>dat/</code> directory), or copy the existing DAT file to a new name and add your parameters to this file.  In the latter case you will need to specify the new forcefield's name on the command line; for instance, if you copy <code>dat/AMBER.DAT</code> to <code>dat/myff.DAT</code>, on the command line you will need to specify <code>--ff=myff</code>.</blockquote>

<B>Adding a whole new forcefield</B>
<blockquote>Similarly, if you want to add a whole new forcefield to PDB2PQR you will have to create a new parameter file.  If the atom naming scheme of the forcefield is not the same as the canonical naming scheme of PDB2PQR, you will need to add patches as well - please see the <a href="programmerguide.html#xml">Programmer's Guide</a> for more information.</blockquote>
</blockquote>

<I> What compilers and architectures are compatible with PDB2PQR?</I>
<blockquote> The PDB2PQR code itself is platform independent, but to use PropKa within PDB2PQR you must compile some code.  PropKa has been tested with the Gnu gcc/g77 compilers on i*86, ia64, x86_64, and Mac OS X (Darwin) systems.  It has also been tested with Intel icc/ifort compilers on i*86 and ia64 systems.  If you find that PDB2PQR/PropKa does not compile on your system please send a <a href="#bug">bug report</a>.</blockquote> 

<I> Can I install PDB2PQR on Windows?</I>
<blockquote> The PDB2PQR code itself is in OS-independent Python, and thus will work with Python under Cygwin.  Unfortunately PropKa makes use of compilers and shared objects, which can be rather tricky through Cygwin.  For basic functionality it is <B>strongly recommended</B> to use PDB2PQR without PropKa enabled; if you would like to try to get PropKa working as well, you might want to look at section 6.2.2 of the <a href="http://www.python.org/doc/2.4.1/inst/tweak-flags.html">Building Extensions</a> in the Python Tutorial.</blockquote> 

<I> How is PDB2PQR licensed?</I>
<blockquote> PDB2PQR is covered under the <a href="http://www.gnu.org/licenses/gpl.txt"> GNU Public License</a>, which basically means you can copy it, change it, use subsets of it, redistribute it, etc.; however, you need to give credit to the original source and the original portion of the code must remain under the GPL.<P>

PropKa is also available under the GNU Public License.</blockquote>

<I> Does the input PDB file need to be in a specific format?</I>
<blockquote> Ideally all input PDB files would be in standard <a href="http://www.rcsb.org/pdb/file_formats/pdb/pdbguide2.2/guide2.2_frame.html">PDB Format</a>.  Since this format assigns information to specific columns, if this information is not present (as in, for example, whitespace delimited files) PDB2PQR may give extraneous results.</blockquote>

<I> Why are the chain IDs not included in the output file?</I>
<blockquote> This is done specifically for APBS, as APBS is unable to handle chain IDs in a PQR file.  To keep the chain IDs in your resulting PQR file please use the <code>--chain</code> option.</blockquote>

<a name="outff"></a>
<I> Can PDB2PQR output create a PQR file using forcefield-specific residue and atom names? </I>
<blockquote> Yes, using the <code>--ffout</code> flag.  Note that for patch-based forcefields a single residue might have different residue names.  Additionally, some forcefield residue names might have 4 letters instead of the standard 3 letters, yielding columns that merge together - if you are using the resulting PQR file for APBS, this will more than likely cause errors.
</blockquote>

<I> What types of residues can PDB2PQR recognize?</I>
<blockquote> PDB2PQR recognizes all of the standard amino acids, nucleic acids, and waters (both WAT and HOH) - for a complete list (and the standard naming scheme) please see the discussion in the <a href="programmerguide.html#canon">Programmer's Guide</a>.</blockquote>

<I> How can I add my own functions to PDB2PQR?</I>
<blockquote> In version 1.1.0 the extensions directory was added, allowing users to add their own post-processing scripts.  For more information please see the appropriate section in the <a href="programmerguide.html#extensions">Programmer's Guide</a>.</blockquote>

<I> I already know the protonation state of a residue.  How can I make PDB2PQR aware of it? </I>
<blockquote>PDB2PQR has the ability to recognize certain protonation states and keep them fixed during optimization. To use this feature manually rename the residue name in the PDB file as follows:<P>
<PRE>
<B>Known Protonation State </B>|<B> New Residue Name</B><BR>
     Neutral ASP        |        ASH
     Negative CYS       |        CYM
     Neutral GLU        |        GLH
     Neutral HIS        | HIE/HID/HSD/HSE 
     Positive HIS       |      HIP/HSP
     Neutral LYS        |        LYN
     Negative TYR       |        TYM
</PRE>
</blockquote>

<I> What causes the following warning - WARNING: PDB2PQR was unable to assign charges to the following atoms</I>
<blockquote> This message usually occurs when atoms belonging to ligands or other residues are not found in the forcefield data file.  As a conversion utility PDB2PQR is unable to assign charges and radii when they are not available in the forcefield - thus this warning message will occur for most ligands.  Occasionally this message will occur in error for a standard amino acid residue where an atom or residue may be misnamed.</blockquote>

<I> What causes the following warning - WARNING: Propka determined the following residues to be in a protonation state not supported by the forcefield!</I>
<blockquote> Some of the protonation states derived from the PropKa results are not supported in the requested forcefield and thus PDB2PQR is unable to get charges and radii for that state.  PDB2PQR currently supports the following states as derived from PropKa:<P>

<PRE>
 <B>Protonation State</B> | <B>AMBER Support</B> | <B>CHARMM Support</B> | <B>PARSE Support</B><br>
Neutral N-Terminus |      No       |       No       |       Yes
Neutral C-Terminus |      No       |       No       |       Yes
Neutral ARG        |      No       |       No       |       No
Neutral ASP        |      Yes*     |       Yes      |       Yes
Negative CYS       |      Yes*     |       No       |       Yes
Neutral GLU        |      Yes*     |       Yes      |       Yes
Neutral HIS        |      Yes      |       Yes      |       Yes
Neutral LYS        |      Yes*     |       No       |       Yes
Negative TYR       |      No       |       No       |       Yes
</PRE><BR>
* - only if residue is not a terminal residue; if the residue is terminal it will not be set to this state
</blockquote>
<hr>

<a name="bug"></a>
<h3>Bug Reports and Suggestions</h3>
Before sending a bug report you may want to check the <a href="http://sourceforge.net/mailarchive/forum.php?forum=pdb2pqr-users">pdb2pqr-users mailing list archives</a> or the existing <a href="http://sourceforge.net/tracker/?group_id=144228&atid=758143">PDB2PQR SourceForge Bug List</a> to make sure your question has not already been addressed. Otherwise please post all bug reports, support requests, or feature requests to the appropriate <a href="http://sourceforge.net/tracker/?group_id=144228">PDB2PQR SourceForge Tracker</a>.<P>
For additional support you may contact the <a href="http://lists.sourceforge.net/lists/listinfo/pdb2pqr-users">pdb2pqr-users mailing list</a>.
<hr><P>
<center><I>Last Updated June 23rd, 2006</I></center><P>

</BODY>
</HTML>
