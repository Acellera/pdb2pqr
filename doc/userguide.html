<HTML>
<HEAD>
<TITLE>PDB2PQR User Guide</TITLE>

</HEAD>
<BODY>
<h2>PDB2PQR User Guide</h2><P>
<B>Table of Contents</B><P>
<a href="#introduction">Introduction</a><BR>
<a href="#availability">Availability</a><BR>
<a href="#installation">Source Installation</a><BR>
<a href="#using">Using PDB2PQR</a><BR>
<a href="#algorithm">Algorithm Descriptions</a><BR>
<a href="#faq">Frequently Asked Questions</a><BR>
<a href="#bug">Bug Reports and Suggestions</a><BR>
<HR>
<a name="introduction"></a>
<h3>Introduction</h3><P>
PDB2PQR is a Python software package that automates many of the common tasks of preparing structures for continuum electrostatics calculations.  This includes adding a limited number of missing heavy atoms to biomolecular structures, optimizing the protein for favorable hydrogen bonding, determining side-chain pKas, and assigning charge and radius parameters from a variety of force fields, ultimately yielding a final PQR file.<P>

PDB2PQR was ported to Python by Todd Dolinsky while working with <a href="http://agave.wustl.edu">Nathan Baker</a> at Washington University in St. Louis.  The PDB2PQR code is based on C++ design and algorithms by Jens Erik Nielsen.  For a full author list please see the <a href="#authors">contributing authors</a>.<P>


PDB2PQR uses <a href="http://propka.chem.uiowa.edu/">PropKa</a> to determine protein pKa values.  PropKa is developed by the <a href="http://www.uiowa.edu/~quantum/">Jensen Research Group</a> at the University of Iowa.  More information about PropKa can be found at  <a href="http://propka.chem.uiowa.edu/">http://propka.chem.uiowa.edu</a>.<P>

<B>Financial support.</B> The development of PDB2PQR has been supported financially by:
<ul>
<li><a href="http://www.nih.gov/">National Institutes of Health</a> (grant GM069702-01)
<li><a href="http://www.npaci.edu/">National Partnership for Advanced Computational Infrastructure</a> Alpha Project program
<li><a href="http://nbcr.sdsc.edu/">National Biomedical Computation Resource</a>
</ul>

<B>Citing PDB2PQR.</B> Please acknowledge your use of PDB2PQR by citing:<P>
<blockquote><a href="http://nar.oupjournals.org/cgi/content/abstract/32/suppl_2/W665">Dolinsky TJ, Nielsen JE, McCammon JA, Baker NA. PDB2PQR: an automated pipeline for the setup, execution, and analysis of Poisson-Boltzmann electrostatics calculations. Nucleic Acids Research 32 W665-W667 (2004).</a></blockquote>

<B>Citing PropKa.</B>  Please acknowledge your use of PropKa by citing:<P>
<blockquote>Hui Li, Andrew D. Robertson, and Jan H. Jensen "Very Fast Empirical Prediction and Interpretation of Protein pKa Values" J. Mol. Biol., submitted.</blockquote>
  
<a name="authors"></a>
<B>Contributing Authors.</B>  PDB2PQR was initially written in C++ by Jens Erik Nielsen before being ported to Python by Todd Dolinsky. The full author list is as follows (in alphabetical order):
<ul>
<li> <a href="mailto:baker@biochem.wustl.edu">Nathan Baker</a> (Washington University in St. Louis)<BR> Advisor and contributor of functions for parsing PDB files.<P>
<li> <a href="mailto:todd@ccb.wustl.edu">Todd Dolinsky</a> (Washington University in St. Louis)<BR> Author of Python code.<P>
<li> <a href="mailto:jan-jensen@uiowa.edu">Jan Jensen</a> (University of Iowa)<BR> Co-author of PropKa.<P>
<li> Hui Li (University of Iowa)<BR> Co-author of PropKa.<P>
<li> <a href="mailto:Jens.Nielsen@ucd.ie">Jens Erik Nielsen</a> (University College Dublin)<BR> Author of initial C++ PDB2PQR code and optimization routines.<P><li> Andrew D. Robertson (University of Iowa)<BR> Co-author of PropKa.<P>
</ul>

<B>Mailing Lists.</B>
There are two mailing lists associated with the PDB2PQR software:<BR>
<ul>
<li>pdb2pqr-announce: A low-traffic list for announcements regarding bugs and new versions of the software<BR>
<a href="http://lists.sourceforge.net/lists/listinfo/pdb2pqr-announce">List web page</a><BR>
<a href="http://sourceforge.net/mailarchive/forum.php?forum=pdb2pqr-announce">List archives</a><P>
<li>pdb2pqr-users: A list for discussion of PDB2PQR, troubleshooting, and reporting potential bugs<BR>
<a href="http://lists.sourceforge.net/lists/listinfo/pdb2pqr-users">List web page</a><BR>
<a href="http://sourceforge.net/mailarchive/forum.php?forum=pdb2pqr-users">List archives</a><P>
</ul>
<HR>

<a name="availability"></a>
<h3>Availability</h3><P>
PDB2PQR is available as both a web service and as command-line software for download.  The PDB2PQR web server can be found at three mirrors:<BR>
<UL>
<li><a href="http://agave.wustl.edu/pdb2pqr/server.html">Washington University in St. Louis</a><BR>
<li><a href="http://nbcr.net/pdb2pqr">NBCR at the San Diego Supercomputer Center (UCSD)</a><BR>
<li><a href="http://enzyme.ucd.ie/Services/pdb2pqr">University College Dublin, Ireland.</a></ul><P>  
The command line PDB2PQR is freely available for download from the SourceForge Project Page at <a href="http://pdb2pqr.sourceforge.net">http://pdb2pqr.sourceforge.net</a>.
<P>
<hr>

<a name="installation"></a>
<h3>Source Installation</h3><P>
As the bulk of the PDB2PQR code is written in Python, the PDB2PQR code itself is architecture/compiler independent.  PDB2PQR has been tested using Python versions 2.2 through 2.4 - problems may occur with older versions.  The PropKa code, however, is written in Fortran - and thus to use it with PDB2PQR a two step installation is necessary, making use of available C and Fortran compilers:<P>
<blockquote><code>
$ ./configure <BR>
$ make <BR>
</code></blockquote>
This should compile the PropKa wrappers necessary to interface with PDB2PQR.<P>  

To install PDB2PQR without propka support, use the --disable-propka flag as follows:<P>
<blockquote><code>
$ ./configure --disable-propka
</code></blockquote>
This will ensure that Python has been found on your system and will set a few global constants.<P>
If the compilation fails please check the <a href="#faq">FAQ</a> section of this user guide, or if all else fails, send a <a href="#bug">bug report</a>.<P>
<HR>

<a name="using"></a>
<h3>Using PDB2PQR</h3><P>

<I>Starting PDB2PQR and Available Options</I><P>
Starting PDB2PQR from the web server is rather straightforward - simply click the desired options, specify or upload a PDB file, and submit the job.  The command line version of PDB2PQR is similar:<P>
<blockquote><code>
$ python pdb2pqr.py [options] --ff={forcefield} {path} {output-path}
</code></blockquote>

The required arguments are as follows:
<ul>
<li> <code>forcefield</code> - The forcefield to use - currently amber, charmm, or parse.
<li> <code>path</code> - The path to the PDB file or an ID to obtain from the PDB archive
<li> <code>output-path</code> - The desired output name of the PQR file to be generated 
</ul>

Available command-line arguments are:
<ul>
<li> <code>--nodebump</code> - Do not perform the <a href="#algorithm">debumping</a> operation.
<li> <code>--noopt</code> - Do not perform the <a href="#algorithm">hydrogen bonding network optimization</a>.
<li> <code>--hbond</code> - Print a list of hydrogen bonds to stdout.
<li> <code>--assign-only</code> - Only assign charges and radii, but do not perform optimizations - effectively turns on both <code> --nodebump</code> and <code>--noopt</code>. 
<li> <code>--with-ph</code> - Use PropKa to calculate pKas and apply them to the molecule given the pH value.  Actual PropKa results will be output to <code>{output-path}.propka</code>.
<li> <code>--apbs-input</code> - Create a template <a href="http://agave.wustl.edu/apbs">APBS</a> input file based on the generated PQR file.
<li> <code>--verbose (-v)</code> - Print additional information to stdout.
<li> <code>--help (-h)</code> - Display the usage information.
</ul>

<hr>
<a name="algorithm"></a>
<h3>Algorithm Descriptions</h3><P>
<I>Debumping Algorithm</I><P>
The debumping algorithm ensures that any new heavy or hydrogen atoms are not rebuilt within the Van der Waals radii of existing atoms.  If this does occur, the sidechain of the residue in question will be rotated about an available &Chi; angle until the steric conflict is resolved.<P>

The number of residues that need to be debumped depends on the nature of the system and if hydrogen optimization will be performed. If hydrogens are the only atoms missing any potential conflicts are usually due to hydrogen bonds, and if optimization is enabled these conflicts are usually resolved during that step.  In the case where a large number of heavy sidechain atoms are missing there could be additional debumping necessary - as the sidechain is rebuilt the initial  &Chi; angle may not be the optimal one, and thus a steric conflict may occur.<P>

<I>Hydrogen Bonding Network Optimization</I><P>
The hydrogen bonding network optimization seeks, as the name suggests, to optimize the hydrogen bonding network of the protein.  Currently this entails manipulating the following residues:
<ul>
<li> Flipping the side chains of HIS (including user defined HIS states), ASN, and GLN residues;
<li> Rotating the sidechain hydrogen on SER, THR, TYR, and CYS (if available);
<li> Determining the best placement for the sidechain hydrogen on neutral HIS, protonated GLU, and protonated ASP;
<li> Optimizing all water hydrogens.
</ul>

<hr>
<a name="faq"></a>
<h3>Frequently Asked Questions</h3><P>

<I> What is a PQR file?</I>
<blockquote> A PQR file is a PDB file with the temperature and occupancy columns replaced by columns containing the per-atom charge (Q) and radius (R).  PQR files are used in several computational biology packages, including <a href="http://agave.wustl.edu/apbs">APBS</a>.</blockquote>

<I> What forcefields are available?</I>
<blockquote> PDB2PQR currently supports AMBER 94, CHARMM 27, and PARSE forcefields.</blockquote>

<I> What compilers and architectures are compatible with PDB2PQR?</I>
<blockquote> PDB2PQR has been tested with the Gnu gcc/g77 compilers on i*86, ia64, x86_64, and Mac OS X (Darwin) systems.  It has also been tested with Intel icc/ifort compilers on i*86 and ia64 systems.  If you find that PDB2PQR does not compile on your system please send a <a href="#bug">bug report</a>.</blockquote> 

<I> Can I install PDB2PQR on my Windows computer?</I>
<blockquote> The PDB2PQR code itself is in OS-independent Python, and thus will work with Python under Cygwin.  Unfortunately PropKa makes use of compilers and shared objects, which can be rather tricky through Cygwin.  For basic functionality it is <B>strongly recommended</B> to configure PDB2PQR with the <code>--disable-propka</code> flag; if you would like to try to get PropKa working as well, you might want to look at section 6.2.2 of the <a href="http://www.python.org/doc/2.4.1/inst/tweak-flags.html">Building Extensions</a> in the Python Tutorial.</blockquote> 

<I> How is PDB2PQR licensed?</I>
<blockquote> PDB2PQR is covered under the <a href="http://www.gnu.org/licenses/gpl.txt"> GNU Public License</a>, which basically means you can copy it, change it, use subsets of it, redistribute it, etc.; however, you need to give credit to the original source and the original portion of the code must remain under the GPL.<P>

PropKa is also available under the GNU Public License.</blockquote>

<I> Does the input PDB file need to be in a specific format?</I>
<blockquote> Ideally all input PDB files would be in standard <a href="http://www.rcsb.org/pdb/info.html#File_Formats_and_Standards">PDB Format</a>.  Since this format assigns information to specific columns, if this information is not present (as in, for example, whitespace delimited files) PDB2PQR may give extraneous results.</blockquote>

<I> Why are the chain IDs not included in the output file?</I>
<blockquote> This is done specifically for APBS, as APBS is unable to handle chain IDs in a PQR file.</blockquote>

<I> What types of residues can PDB2PQR recognize?</I>
<blockquote> PDB2PQR recognizes all of the standard amino acids, nucleic acids, and waters (both WAT and HOH) - for a complete list see the data files found in dat/AA.DAT and dat/NA.dat.</blockquote>

<I> I know the charge and radius of an atom not included in the selected forcefield.  How can I make PDB2PQR include these parameters? </I>
<blockquote> The best way to do this is to add another line for each atom to the DAT file for the selected forcefield - these files can be found in the <code>dat</code> directory. Be sure to use the same atom/residue name as appears in your PDB file.</blockquote>

<I> I already know the protonation state of a residue.  How can I make PDB2PQR aware of it? </I>
<blockquote>PDB2PQR has the ability to recognize certain protonation states and keep them fixed during optimization. To use this feature manually rename the residue name in the PDB file as follows:<P>
<PRE>
<B>Known Protonation State </B>|<B> New Residue Name</B><BR>
     Neutral ASP        |        ASH
     Negative CYS       |        CYM
     Neutral GLU        |        GLH
     Neutral HIS        | HIE/HID/HSD/HSE if location of hydrogen is known
                        | HSN if location of hydrogen is unknown
     Positive HIS       |      HIP/HSP
     Neutral LYS        |        LYN
     Negative TYR       |        TYM
</PRE>
</blockquote>

<I> What causes the following warning - WARNING: PDB2PQR was unable to assign charges to the following atoms</I>
<blockquote> This message usually occurs when atoms belonging to ligands or other residues are not found in the forcefield data file.  As a conversion utility PDB2PQR is unable to assign charges and radii when they are not available in the forcefield - thus this warning message will occur for most ligands.  Occasionally this message will occur in error for a standard amino acid residue where an atom or residue may be misnamed.</blockquote>

<I> What causes the following warning - WARNING: Propka determined the following residues to be in a protonation state not supported by the forcefield!</I>
<blockquote> Some of the protonation states derived from the PropKa results are not supported in the requested forcefield and thus PDB2PQR is unable to get charges and radii for that state.  PDB2PQR currently supports the following states as derived from PropKa:<P>

<PRE>
 <B>Protonation State</B> | <B>AMBER Support</B> | <B>CHARMM Support</B> | <B>PARSE Support</B><br>
Neutral N-Terminus |      No       |       No       |       Yes
Neutral C-Terminus |      No       |       No       |       Yes
Neutral ARG        |      No       |       No       |       No
Neutral ASP        |      Yes*     |       Yes      |       Yes
Negative CYS       |      Yes*     |       No       |       Yes
Neutral GLU        |      Yes*     |       Yes      |       Yes
Neutral HIS        |      Yes      |       Yes      |       Yes
Neutral LYS        |      Yes*     |       No       |       Yes
Negative TYR       |      No       |       No       |       Yes
</PRE><BR>
* - only if residue is not a terminal residue; if the residue is terminal it will not be set to this state
</blockquote>
<hr>

<a name="bug"></a>
<h3>Bug Reports and Suggestions</h3>
Before sending a bug report you may want to check the <a href="http://sourceforge.net/mailarchive/forum.php?forum=pdb2pqr-users">pdb2pqr-users mailing list archives</a> or the existing <a href="http://sourceforge.net/tracker/?group_id=144228&atid=758143">PDB2PQR SourceForge Bug List</a> to make sure your question has not already been addressed. Otherwise please post all bug reports, support requests, or feature requests to the appropriate <a href="http://sourceforge.net/tracker/?group_id=144228">PDB2PQR SourceForge Tracker</a>.<P>
For additional support you may contact the <a href="http://lists.sourceforge.net/lists/listinfo/pdb2pqr-users">pdb2pqr-users mailing list</a>.
<hr><P>
<center><I>Last Updated August 22nd 2005</I></center><P>

</BODY>
</HTML>
